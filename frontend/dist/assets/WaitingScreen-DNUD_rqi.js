import{y as T,e as l,f as t,x as w,l as o,h as A,F as f,p as m,z as I,A as C,B as b,d as k,s as d,n as y,g as N}from"./index-D1dayd5A.js";const x={name:"WaitingScreen",data(){return{currentTurns:[],waitingByArea:{},totalWaiting:0,currentTime:"",currentDate:"",lastUpdate:"",previousTurnIds:new Set,newTurnIds:new Set,refreshInterval:null,clockInterval:null}},mounted(){this.updateClock(),this.fetchDisplayData(),this.refreshInterval=setInterval(()=>{this.fetchDisplayData()},5e3),this.clockInterval=setInterval(()=>{this.updateClock()},1e3)},beforeUnmount(){this.refreshInterval&&clearInterval(this.refreshInterval),this.clockInterval&&clearInterval(this.clockInterval)},methods:{async fetchDisplayData(){try{const e=await k.get("/turn/display");if(e.data.success){const s=e.data.current||[],u=new Set(s.map(i=>i.id));for(const i of s)this.previousTurnIds.has(i.id)||(this.newTurnIds.add(i.id),this.playNotificationSound(),setTimeout(()=>{this.newTurnIds.delete(i.id)},3e3));this.previousTurnIds=u,this.currentTurns=s,this.waitingByArea=e.data.waiting_by_area||{},this.totalWaiting=e.data.total_waiting||0,this.lastUpdate=new Date().toLocaleTimeString("es-PE")}}catch(e){console.error("Error fetching display data:",e)}},updateClock(){const e=new Date;this.currentTime=e.toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),this.currentDate=e.toLocaleDateString("es-PE",{weekday:"long",year:"numeric",month:"long",day:"numeric"})},getAreaShortName(e){return{DGI:"Gesti√≥n Institucional",DGP:"Gesti√≥n Pedag√≥gica",TRAMITE:"Tr√°mite Documentario",ACTAS:"Actas y Certificados",TESORERIA:"Tesorer√≠a",ESCALAFON:"Escalaf√≥n",RRHH:"Recursos Humanos",OCI:"Control Institucional",DIRECCION:"Direcci√≥n Regional",LEGAL:"Asesor√≠a Legal"}[e]||e},isNewTurn(e){return this.newTurnIds.has(e)},playNotificationSound(){try{const e=new(window.AudioContext||window.webkitAudioContext),s=(i,a,r,p=.4)=>{const n=e.createOscillator(),c=e.createGain(),h=e.createOscillator(),v=e.createGain(),g=e.createOscillator(),_=e.createGain();n.connect(c),h.connect(v),g.connect(_),c.connect(e.destination),v.connect(e.destination),_.connect(e.destination),n.frequency.value=i,h.frequency.value=i*2,g.frequency.value=i*3,n.type="sine",h.type="sine",g.type="sine",c.gain.setValueAtTime(0,a),c.gain.linearRampToValueAtTime(p,a+.01),c.gain.exponentialRampToValueAtTime(.001,a+r),v.gain.setValueAtTime(0,a),v.gain.linearRampToValueAtTime(p*.5,a+.01),v.gain.exponentialRampToValueAtTime(.001,a+r*.7),_.gain.setValueAtTime(0,a),_.gain.linearRampToValueAtTime(p*.25,a+.01),_.gain.exponentialRampToValueAtTime(.001,a+r*.5),n.start(a),h.start(a),g.start(a),n.stop(a+r),h.stop(a+r),g.stop(a+r)},u=e.currentTime;s(784,u,.8,.5),s(659,u+.35,1,.5),s(523,u+.75,.6,.25)}catch(e){console.log("No se pudo reproducir el sonido:",e)}}}},D={class:"waiting-screen"},E={class:"screen-header"},B={class:"header-right"},S={class:"datetime-display"},R={class:"time"},V={class:"date"},G={class:"main-content"},L={class:"current-turns-section"},M={key:0,class:"current-turns-grid"},P={class:"turn-number"},O={class:"turn-info"},U={class:"turn-area"},F={class:"turn-window"},z={key:1,class:"no-current-turns"},H={class:"waiting-panel"},q={class:"areas-waiting-list"},W={class:"area-header"},j={class:"area-prefix"},Q={class:"area-name"},Y={class:"area-count"},Z={class:"count-label"},J={key:0,class:"area-next"},X={class:"screen-footer"},K={class:"footer-left"},$={class:"total-waiting"},tt={class:"footer-center"},et={class:"footer-right"},st={class:"last-update"},at={ref:"notificationSound",preload:"auto"};function nt(e,s,u,i,a,r){const p=b("marquee");return d(),l("div",D,[t("header",E,[s[0]||(s[0]=w('<div class="header-left" data-v-1cab9845><div class="dre-logo" data-v-1cab9845><svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1cab9845><path d="M12 14l9-5-9-5-9 5 9 5z" data-v-1cab9845></path><path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z" data-v-1cab9845></path><path d="M12 14l9-5-9-5-9 5 9 5z" data-v-1cab9845></path><path d="M12 14v7" data-v-1cab9845></path></svg><div class="logo-text" data-v-1cab9845><span class="logo-title" data-v-1cab9845>DRE HU√ÅNUCO</span><span class="logo-subtitle" data-v-1cab9845>Sistema de Turnos</span></div></div></div>',1)),t("div",B,[t("div",S,[t("span",R,o(a.currentTime),1),t("span",V,o(a.currentDate),1)])])]),t("main",G,[t("section",L,[s[3]||(s[3]=t("h2",{class:"section-title"},[t("span",{class:"pulse-dot"}),A(" ATENCI√ìN ACTUAL ")],-1)),a.currentTurns.length>0?(d(),l("div",M,[(d(!0),l(f,null,m(a.currentTurns,n=>(d(),l("div",{key:n.id,class:y(["current-turn-card",{"new-turn":r.isNewTurn(n.id)}])},[t("div",P,o(n.numero_turno),1),t("div",O,[t("span",U,o(r.getAreaShortName(n.codigo_area)),1),t("span",F,"Ventanilla "+o(n.ventanilla||"1"),1)]),s[1]||(s[1]=t("div",{class:"turn-arrow"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[t("path",{d:"M5 12h14M12 5l7 7-7 7"})])],-1))],2))),128))])):(d(),l("div",z,[...s[2]||(s[2]=[t("svg",{class:"waiting-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("polyline",{points:"12,6 12,12 16,14"})],-1),t("p",null,"Esperando siguiente turno...",-1)])]))]),t("aside",H,[s[5]||(s[5]=t("h2",{class:"section-title"},"EN ESPERA",-1)),t("div",q,[(d(!0),l(f,null,m(a.waitingByArea,(n,c)=>(d(),l("div",{key:c,class:y(["area-waiting-card",{"has-waiting":n.count>0}])},[t("div",W,[t("span",j,o(n.prefijo),1),t("span",Q,o(r.getAreaShortName(c)),1)]),t("div",Y,[A(o(n.count)+" ",1),t("span",Z,o(n.count===1?"turno":"turnos"),1)]),n.turns&&n.turns.length>0?(d(),l("div",J,[s[4]||(s[4]=A(" Pr√≥ximo: ",-1)),t("strong",null,o(n.turns[0].numero_turno),1)])):N("",!0)],2))),128))])])]),t("footer",X,[t("div",K,[t("span",$,[s[6]||(s[6]=w('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-1cab9845><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" data-v-1cab9845></path><circle cx="9" cy="7" r="4" data-v-1cab9845></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87" data-v-1cab9845></path><path d="M16 3.13a4 4 0 0 1 0 7.75" data-v-1cab9845></path></svg>',1)),A(" "+o(a.totalWaiting)+" personas en espera ",1)])]),t("div",tt,[I(p,{behavior:"scroll",direction:"left",scrollamount:"3"},{default:C(()=>[...s[7]||(s[7]=[A(" üéâ Bienvenidos a la Direcci√≥n Regional de Educaci√≥n Hu√°nuco ‚Ä¢ Por favor, espere su turno y mantenga el orden ‚Ä¢ Gracias por su visita üéâ ",-1)])]),_:1})]),t("div",et,[t("span",st,"Actualizado: "+o(a.lastUpdate),1)])]),t("audio",at,[...s[8]||(s[8]=[t("source",{src:"data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleP+CXYCD/7+d/06b/wAA",type:"audio/wav"},null,-1)])],512)])}const it=T(x,[["render",nt],["__scopeId","data-v-1cab9845"]]);export{it as default};
